# オセロ

## 1．概要
書籍「実装　ディープラーニング」の三目並べサンプルをベースに、オセロゲームを自作して DQN(Experience Replay)強化学習を実施してみました。
自作オセロはボードサイズを選ぶことができ(6x6 以上の偶数サイズ)、ある確率で、ボードの角と端を、または最も多くコマが取れる場所を優先して取りに行き、それ以外はランダムで場所を取るという実装で、自分(人間)で対戦した場合、自分の勝率が 9 割程度の強さです。
書籍のサンプル通り 50000 ゲーム(Episode)を実施し、結果を出力します。

## 2．構成
スクリプト 4 つで構成されます。下記の エージェント、環境、実験を rl_glue で結合します。

### agent.py(エージェント)
ビデオゲームではプレイヤーに当たります。Environment から情報を受け取り、強化学習によってアクションを決定し、環境に伝えます。より多くの報酬を得ることが目的になります。

### environment.py+game_reversi.py(環境)
この二つを合わせて、環境を構成します。ビデオゲームそのものに当たります。エージェントのアクションに対して、応答するアクションを行いゲームの状態、報酬を与えます。エージェントはこれに勝つことで報酬を得ます。
environment.py がエージェントに対するインターフェースを提供し、game_reversi.py が、オセロゲームのロジックを実現します(ゲーム機本体と、カートリッジやディスクの関係と似ています)。

### experiment.py(実験)
実験です。ビデオゲームではスタート、終了、スコアランキングなどを制御するプログラムにあたります。このスクリプトを実行することで、エージェントと環境が対戦を始めます。既定の回数(50000エピソード)を完了すると、勝率をグラフに出力します。

## 3．実行環境
以下環境情報。インストール手順等は、書籍「実装 ディープラーニング」をご参照ください。
### マシンの構成:
#### PC:
AMD A10-7870K Radeon R7  
Memory 32GB
#### GPU:
Geforce GTX 1050 (玄人志向 GF-GTX1050-2GB/OC/SF)
#### OS:
Ubuntu 16.04 LTS
### 各コンポーネントのバージョン:
CuDA 8.0, V8.0.61   
CuDNN 8.0 v5.1  
Python 2.7.13( on Anaconda 4.3.11)
Numpy 1.12.0  
Matplotlib 1.5.3  
rl_glue Version 3.04, Build 909  
chainer 1.21.0

セットアップ手順は、「実装 ディープラーニング」に従っています。

## 4．実行手順  
「実装 ディープラーニング」の三目並べの起動手順と同じです。ターミナルを 4 つ起動し、それぞれ以下を実行します。  
### 1つ目のターミナル:  
rl_glue  
### 2つ目のターミナル:  
. activate main  
python agent.py --gpu 0 --size 8  
注)  
CPU で実行する場合は "--gpu"　無しで実行します。  
--size は ボードの1辺のマス数で、6 以上の偶数を指定します。

### 3つ目のターミナル:  
. activate main  
python environment.py  
### 4つ目のターミナル:  
. activate main  
python experiment.py  

experience.py が起動すると、以下の動画のようにオセロゲームが始まります。  
[![Reversi played by simple DQN agent.]<iframe width="560" height="315" src="https://www.youtube.com/embed/qwigP7s1PU4" frameborder="0" allowfullscreen></iframe>]


なお、現時点では実行後にモデルをファイルに書き出す実装は行っていません。実行するたびにゼロから学習のやり直しになります。
また、三目並べに比べてオセロは複雑ですが、エージェントのロジックが三目並べとほぼ同じであるためか、書籍のように　100% の勝率にはなりません。

## 5．参考 URL など
"実装　ディープラーニング"  
http://shop.ohmsha.co.jp/shopdetail/000000004775/  
クラバートの樹 No.180 - アルファ碁の着手決定ロジック（１）
http://hypertree.blog.so-net.ne.jp/2016-06-17  
